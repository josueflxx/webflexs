{% extends 'base.html' %}

{% block title %}Checkout - FLEXS{% endblock %}

{% block content %}
<div class="checkout-page">
    <div class="container">
        <h1>Confirmar Pedido</h1>

        <form method="post" class="checkout-layout">
            {% csrf_token %}

            <div class="checkout-items">
                <h3>Productos ({{ cart.get_item_count }})</h3>
                {% for item in cart.items.all %}
                <div class="checkout-item">
                    <span class="item-qty">{{ item.quantity }}x</span>
                    <span class="item-name">{{ item.product.name }}</span>
                    <span class="item-price">${{ item.subtotal|floatformat:2 }}</span>
                </div>
                {% endfor %}

                <div class="form-group" style="margin-top: 2rem;">
                    <label for="notes" class="form-label">Notas para el pedido (opcional)</label>
                    <textarea name="notes" id="notes" class="form-textarea" rows="3"
                        placeholder="Indicaciones de entrega, observaciones, etc."></textarea>
                </div>
            </div>

            <div class="checkout-summary">
                <h3>Resumen del Pedido</h3>
                <div class="summary-row">
                    <span>Subtotal</span>
                    <span>${{ subtotal|floatformat:2 }}</span>
                </div>
                {% if discount %}
                <div class="summary-row discount">
                    <span>Descuento ({{ discount_display|floatformat:0 }}%)</span>
                    <span>-${{ discount_amount|floatformat:2 }}</span>
                </div>
                {% endif %}
                <div class="summary-row total">
                    <span>Total</span>
                    <span>${{ total|floatformat:2 }}</span>
                </div>

                <button type="submit" class="btn btn-primary btn-lg btn-block">
                    Confirmar Pedido
                </button>
                <a href="{% url 'cart' %}" class="btn btn-outline btn-block">Volver al Carrito</a>
            </div>
        </form>
    </div>
</div>

<style>
    .checkout-page { padding: var(--spacing-2xl) 0; }
    .checkout-page h1 { margin-bottom: var(--spacing-2xl); }
    .checkout-layout { display: grid; grid-template-columns: 1fr 350px; gap: var(--spacing-2xl); }
    .checkout-items { background: var(--color-dark-light); padding: var(--spacing-xl); border-radius: var(--radius-lg); }
    .checkout-item { display: flex; gap: var(--spacing-md); padding: var(--spacing-md) 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
    .checkout-item .item-qty { font-weight: 600; color: var(--color-primary); min-width: 40px; }
    .checkout-item .item-name { flex: 1; }
    .checkout-summary { background: var(--color-dark-light); padding: var(--spacing-xl); border-radius: var(--radius-lg); height: fit-content; position: sticky; top: 120px; }
    .summary-row { display: flex; justify-content: space-between; padding: var(--spacing-md) 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
    .summary-row.discount { color: var(--color-success); }
    .summary-row.total { font-size: var(--font-size-xl); font-weight: 700; color: var(--color-primary); border-bottom: none; }
    .checkout-summary .btn { margin-top: var(--spacing-md); }
    .btn-block { width: 100%; text-align: center; }
    @media (max-width: 768px) { .checkout-layout { grid-template-columns: 1fr; } }
</style>
{% endblock %}
